import yfinance as yf
from datetime import datetime, timedelta
import pandas as pd
import time

# Combine all tickers into one list
TICKERS = [
    'CRWD', 'NVDA', 'MSFT', 'GOOGL', 'ENPH', 'JPM', 'IFS', 'AMZN', 'IBM', 'C', 'KMB',
    'IBKR', 'NFLX', 'V', 'AVGO', 'UEC', 'VZ', 'NU', 'CCJ', 'T', 'CCL', 'TMUS', 'PM',
    'MA', 'SHOP', 'TCOM', 'RKLB', 'ULTA', 'BAP', 'AAPL', 'TSLA', 'META', 'JNJ', 'PG',
    'BAC', 'KO', 'PEP'
]

TICKERS = ['BHRB','CHRD','CELH','NVDA','SAVA','CLDX','GME','SMCI','WFRD','FTLF','INDV','AMR','TSLA','HDSN','ESOA','HOV','BBW','LRMR','LMB','DAC','INOD','SCWO','LEU','FTAI','BYRN','SITM','AEHR','COOP','EP','EU','STRL','MOD','MNMD','SMMT','VIST','ESEA','LFMD','LLY','BLDR','TGLS','PMTS','CAMT','ANF','ENLT','UFPT','MSTR','FIX','BELFA','AMRK','GRBK','IESC','FRHC','VKTX','MARA','USLM','ACCD','ELF','ITCI','VSTO','PWR','VRT','LWAY','THC','ZJYL','REAX','HROW','AVDL','AR','RCMT','NVMI','PECO','BNTX','RRC','DKS','VRNA','SKE','CARR','CLMB','DDS','AXON','ACLS','IDR','TMDX','MUSA','URI','DFIN','TNK','CALX','CLS','OBE','DECK','SGML','NVO','HWKN','FTEL','BELFB','AVGO','MPWR','ANET','ARES','TRNS','SFM','CEIX','LNW','TBBK','SIG','MLI','FUTU','IDYA','BHVN','CROX','BTBT','ONTO','KLAC','FICO','LINC','DRS','MNKD','TFII','CATX','PANW','AEYE','TAYD','FTNT','PI','SANG','BCC','TTD','KNSL','TRMD','NUVL','LNTH','COKE','KKR','OPXS','ENPH','BLTE','MRNA','TDW','GPI','SMTI','TGB','UEC','RDNT','ELA','KRYS','AMD','MTSI','MLTX','WMS','POWL','FCX','IRM','WSM','RYDE','MHO','UTHR','SGRY','CLMT','SAIA','TRGP','CYTK','PCVX','AAPL','ACLX','CEG','NET','TROO','CSWI','ARGX','FCNCA','UMC','CRAI','IDT','MEDP','TPL','CCJ','ASO','MBIN','STLD','WING','SPSC','EME','LPX','REGN','ATLC','EVH','NSIT','GSL','XENE','LPG','AGYS','SMID','ASPN','MMYT','MIRM','TSM','PHM','DELL','INSM','BOOT','DHI','XPO','TOL','TT','AXR','NSYS','NXE','BLD','FN','NRP','AXSM','PIPR','NTRA','PAM','AIT','IBP','HALO','LWLG','ETN','KOSS','GE','SM','KAI','CRWD','MPC','BMI','CHCI','ROAD','FLEX','LEN','MCK','CNQ','PGR','ON','STN','AMAT','CDNS','ABBV','DY','PATK','GFF','SPXC','PFSI','DKNG','PAG','GGAL','CRVL','GWW','LYTS','CECO','IT','AVNW','SCCO','HWM','QRHC','CCS','MATX','AJG','PH','MELI','EDN','GSAT','HLI','JEF','BRBR','IMVT','AMP','TGTX','LRCX','ODFL','KEQU','CCB','ENSG','FSLR','GSM','JBL','XPEL','RXST','AMLI','PFMT','ORLA','COLL','ARCB','SNPS','JOE','ACMR','CEPU','ASML','TATT','ARLO','NOW','VERA','CTAS','AN','VIRC','CLFD','ADMA','BX','CRC','CMG','COST','PLTR','NGVC','CMC','MAMA','SIM','ENVA','HCA','INSW','BXC','APG','REPX','HL','RIOT','WCC','AVAV','AMKR','DNN','MMSI','NBN','EVR','TXRH','VST','NMM','APO','MANH','MYRG','TLN','VCTR','MSFT','CNX','MHLD','HRI','GMS','NVT','CAVA','CLH','CVLT','TPH','ZTEK','MRUS','IR','RACE','IMO','UBS','RMBS','SPLP','NUE','ZEUS','MTDR','FRO','FLNG','ALNY','LNG','SLVM','UFPI','CBZ','INSP','VECO','GERN','TWI','HRB','CVLG','SKY','CPRX','BRO','CRNX','EGY','AM','WSO','PBR','JAKK','CLPT','ATI','HUBB','ALT','CRH','LRN','CAT','GLSI','ABUS','MTH','COR','GLP','CWH','TRAK','CSL','BCYC','EXP','SNEX','AGI','PJT','DDOG','UTI','ISRG','TSCO','VCEL','REVG','CAAP','EXPI','RS','TDG','ATKR','OC','APH','HUBS','LQDT','ZETA','KBH','AAON','CRS','ORCL','TTEK','PR','BGI','BWIN','KFS','AMRX','CAH','EQT','UNH','LMAT','PGHL','DLNG','ORLY','GFI','BJ','KRUS','ELMD','FERG','RUSHA','NTZ','MOH','AZO','CORT','R','BKE','TW','SWBI','HMY','TRI','GMGI','NECB','LPLA','NSSC','CORZ','DNTH','FRPT','MSI','AMTX','FIP','TIPT','LIVE','MRVL','FSS','SWN','PSN','VRTX','IDCC','IBN','ASTS','ACGL','PLMR','PDD','TMHC','TPX','STGW','ELTK','META','LIN','CRIS','CMT','ACHC','FLXS','ASC','SSD','ARC','MS','PBT','YPF','IBRX','KROS','ALTR','AOSL','SCVL','EXLS','X','VSEC','DE','PSTG','JXN','RRR','HIVE','NEON','KNSA','SE','GVA','GS','EDRY','PRIM','FLL','BBVA','GNE','MPTI','DVAX','FLUT','IPX','IBKR','GOLF','BCRX','TFIN','GOOG','CAR','ZS','BMA','WFG','MPLX','GOOGL','PTGX','CWST','RSG','TGS','BBAR','DLHC','TECK','TTSH','HCI','MDGL','SFBS','ESI','QFIN','HIMX','HGBL','BECN','TMUS','OLN','ERIE','MSCI','XPL','CYBR','CPSS','RUSHB','ACM','MMC','ESQ','STKL','SNX','CMRE','DVA','KBR','PESI','GLNG','WMB','NEOV','CBT','BLBD','TEVA','HCC','HLNE','SUPV','ENTG','CRUS','AGM','NWG','PTC','FRD','AFL','NVR','RICK','SPOT','FG','BYD','CPRT','ACA','AX','PNR','UCTT','AGX','BZH','GRMN','WSC','PCAR','RYI','DSGX','GFL','DRD','CUBI','NTNX','GCBC','BSIG','MTUS','LII','PRTA','SGRP','SXI','MC','NLOP','ASTH','IRMD','WAB','LQDA','DHT','FAST','APPF','MLP','STNG','ENLC','VAL','DT','OPCH','HLT','CI','LOW','VRNS','COP','LASE','CW','CRTO','STC','RYAN','FIZZ','KR','FANG','LOB','PLPC','PAR','NPO','INTU','LUMO','NAT','RYTM','FORM','SF','CNO','ELV','JHX','TYL','GDEN','NXPI','GDDY','QCOM','MCO','SLM','BLK','ING','PM','CASY','BSVN','NDAQ','PDFS','CIVI','NFLX','SKT','FOUR','RDVT','SOC','VGR','PDS','HESM','PBH','FBP','SN','NTAP','MGY','WINA','ROL','CHDN','GRVY','RJF','APGE','UNM','THO','GPK','ABG','AROC','CDRE','SB','RBA','USAP','AMSC','ANDE','WLK','FND','DHR','INFY','ITT','FLR','KTB','SPTN','NRG','PRI','AXP','JILL','TJX','RELX','ESTA','SD','SNDX','GLOB','PKG','SHW','BTE','UUUU','CLW','UBER','SNFCA','DB','ODC','ACU','BAH','OTIS','KGEI','RELL','MDB','AZN','MRO','NVAX','SUN','SKWD','CASH','BRAG','WMT','HIG','TK','TER','AMPH','JPM','BE','LECO','TX','SENEA','CACI','DHAI','HES','HQI','NOVT','OFG','WPM','TMO','SENEB','VTSI','DJCO','PNTG','ASX','WCN','UHAL','STEP','CVCO','PLUS','AFBI','EFX','WOR','WD','VLO','HPQ','LBPH','CRDO','OMI','KEN','ICFI','AMRC','CIGI','RDY','FELE','CMI','CALT','ADI','AXNX','UAN','LAKE','WTS','LAD','TSEM','INTR','BBWI','MLM','ZDGE','WST','DGII','TPCS','CTVA','SANM','WRB','METC','CBRE','SAH','AGRO','LOGI','PLAB','BDC','MUFG','SPGI','BIPC','AMAL','SPFI','ELVA','GASS','MTD','KNF','CBNK','HLIT','ADBE','QCRH','RRX','OBT','XOM','CXT','CENX','FCN','MTG','NGD','RCUS','FBIZ','CAAS','LSCC','PANL','DBD','BCS','AVY','AMG','ICLR','GKOS','JHG','ALL','EXTR','CVE','VICI','DIT','WES','TPC','SEM','CR','USAC','MFC','WHD','CB','EQH','BANF','DMLP','STX','SPNS','PLBC','HUBG','BSX','KFRC','TKR','HBM','VMI','BLX','KB','OCUL','ATEN','OPY','H','NL','PLXS','CARS','HHS','TEX','CM','HBB','HZO','PRK','MORN','SLNO','NWS','ORI','ALSN','KODK','A','SMFG','DAR','CDW','MDIA','PRFT','BPOP','DOV','MWA','RY','HAYN','CNM','MET','EOG','NVCT','NWSA','SAP','MAS','SNA','AYI','DVN','CIX','GSHD','EHC','IPAR','PAC','RMD','CNXN','IPWR','GPOR','DXCM','BKNG','WM','KRG','AME','RYAM','RYAAY','ERJ','EQNR','IVT','LGND','HEI','ESAB','ACN','AON','SVRA','STRT','EWBC','AMZN','BG','SYNA','SHOP','LDOS','IBM','VVV','ICE','RL','OVV','SOWG','COCO','GBX','MLR','EPIX','LBRT','CAL','CMCL','CNS','PWP','SOL','ARM','GEF','PRMW','AMGN','CBOE','NRIM','VRRM','DKL','EGO','FDX','LINK','ULH','AVXL','CP','SKX','GOGL','BOX','FLGT','SBLK','SO','MUR','MO','AGO','MAT','PAYX','BITF','PRCT','BBSI','DSGR','IMKTA','GATX','WT','MCBS','LAAC','AZZ','ARCT','INGR','SJT','ET','ATS','PRKS','CENT','RAIL','ACTG','FUL','MAR','FITB','ODP','CMBT','CFBK','KLIC','RBC','VALU','GIFT','PCG','FWONK','WMK','TXT','TTE','GNK','SLI','AZPN','TRUP','MU','IGIC','CWCO','RGEN','WAL','KFY','DTM','TXN','SIMO','ADP','ITW','IOT','RPM','JCI','URG','TRN','POOL','KGC','GGG','HEES','FSUN','RNGR','WGO','VRTS','IDXX','FSBW','FSV','ASR','IBCP','LXU','GD','OKE','COHU','NX','COHR','SYM','NYT','EXR','TRV','IIIN','VRSK','UTZ','BERY','MCHP','EAT','SYK','HD','ELP','DPZ','BGC','PNFP','SLGN','NGG','GATO','ACT','NDSN','PRPH','CWEN','TPR','IMMP','SCI','FWONA','RIO','RLI','FBIN','EMR','XYL','CSPI','SITE','PRU','JLL','ABCB','LAMR','Z','JNPR','ITGR','CF','MA','GTLS','ROK','GNRC','UI','APAM','ALTO','VIRT','MRK','ITIC','VTOL','MCRI','DJT','JBDI','DFS','CHKP','HNI','ADM','ESGR','SWTX','NHC','ISSC','PLD','VMC','CYH','BK','GIC','LEGH','ARW','KNTK','IZEA','LMT','BCPC','SBR','IRS','ATGE','CTO','AFG','MNST','SPB','PDEX','NOG','APOG','CCEP','KGS','BN','DOOO','CDMO','CLBT','NNI','BH','ORRF','MGPI','STE','POST','HTGC','HURN','REX','IBOC','WIT','BWMN','SAIC','MTRN','UNTY','NXST','APT','PSA','UNP','BR','EXPD','SMBC','COF','AEIS','TENB','IGT','WRN','ICCH','AEG','ZG','WTFC','AHR','BWXT','HOLX','MVO','OSTX','INVA','STT','CVEO','EQIX','CENTA','FFNW','CL','GTES','CHCO','ADSK','FER','LSTR','SUM','WK','ETD','GLW','INBK','SYBT','TEL','SCHW','UMH','OMF','PBPB','WTM','SFBC','JANX','AOS','PBI','TKO','MGRC','THRY','VRN','IPG','GTIM','CRM','WELL','NEE','FDUS','BKR','VNOM','ALC','AER','UMBF','STLA','SPT','ZBRA','SWKH','GENC','PG','TTI','FPI','ULTA','NWPX','ENS','WLFC','L','ENB','AMH','HCKT','AIZ','ADUS','IHG','RH','FDS','CCEC','CPHC','DXLG','PACS','TECH','BTI','GHM','EPAC','CVNA','DAKT','HNRG','OII','KHC','IQV','RCAT','NIO','PFBC','NVGS','MSA','WTW','SNY','V','FI','CUBE','OZK','TSQ','EPRT','K','OTTR','GIS','RDN','RTX','HVT','CHK','NVS','CALM','MBC','KOF','MVIS','IRT','OWL','MHH','ROP','SOTK','CG','DQ','AVTR','EGP','OPHC','TGT','NOC','J','PCTY','ROCK','BATRA','FKWL','BRX','LKFN','RF','PEG','SEZL','CLF','NSC','PFGC','LPTH','PNC','CSV','EBAY','DIOD','GOGO','GWRE','SCSC','NEM','DUOL','BILL','ARLP','ASM','ZTS','BIOX','SONY','HOMB','UHS','LYB','CSX','PSX','SII','TEN','NAMS','SU','NMRK','HEAR','KDP','GGB','GAM','ABM','INTA','INTT','SYPR','QNST','QLYS','FR','INLX','IX','FEBO','EVRI','SSBK','OVLY','IIPR','BAC','CNC','DGX','NSA','NGS','CGBD','BY','NTES','ACIW','DUK','CSQ','BGNE','SLF','BRKR','CAPL','KO','UNFI','EG','RBCAA','CTS','BBY','GPC','ARCH','ONEW','GNW','CAPR','BC','WAT','EIX','ASA','AZEK','QMMM','MTZ','HSBC','AEM','NOA','LH','TROX','STAG','ATAT','NATR','WWD','DXPE','SYF','ATMU','PRGS','TBBB','WH','FOR','CSWC','FNF','LB','PEP','PFG','MCD','EMN','XOMA','PEN','JBHT','ESE','LFUS','VEEV','MDLZ','EA','HAL','RCKT','KT','EXPO','WDAY','SRPT','ABVX','STM','AIG','TARS','ALG','EPD','JNJ','BHE','SBS','BRT','TNET','DOW','FFIV','MRBK','BHB','ORN','CHUY','ABT','SSNC','EQBK','DCO','VERX','CHD','TILE','MPU','EZPW','SQM','FINV','HBT','SIGA','MDU','NMIH','BATRK','TTMI','LKQ','HLN','WDFC','CCK','CX','GILD','PODD','KEX','PPC','CET','MBWM','ROST','USM','PGNY','BMO','SHEL','BFC','KEYS','MLSS','CVX','CRL','LOMA','RCL','SLMBP','ERII','RVMD','BRC','AU','BSY','DMAC','AIR','NMR','NTB','NTLA','LYG','SDRL','DCI','LAZ','RGT','CLSD','COO','TH','TPG','MTX','DFH','PLYM','DORM','FCF','SDHC','ELVN','PERI','GLPI','MEC','GMED','HWC','FNB','SMBK','RGA','VEL','GIB','SOR','MT','GAU','KMI','URBN','HSY','ANSS','GEHC','GPCR','PKX','PSO','RNA','WEYS','NIC','TRMB','AVNT','FIHL','TRNO','COGT','FSBC','BCO','ALLE','FRBA','TSLX','IAG','AA','GROW','AB','ZIM','TY','OR','HMC','TKC','LOAR','USFD','VBFC','E','VLTO','AIO','OPBK','TAC','AVBP','EPSN','LSAK','PNNT','HSII','ADT','APD','GEV','CII','LMNR','CCBG','TS','VIPS','OLLI','RMT','HIMS','PSMT','BCX','HIFS','RNR','MP','IP','ULS','VTS','LIF','SPNT','F','SAN','OMC','DLR','TREX','TNC','DYN','VOYA','ASGN','BPRN','DNLI','OSBC','BGR','RVTY','WNC','CCAP','SGU','GPRE','QRVO','ED','KNX','SRE','ADEA','MGNI','SPG','BHP','NBTB','MFIN','NE','VALE','MSM','KYMR','QUIK','SXC','CTRE','GDYN','BOKF','BEP','HSON','FSCO','FUND','SPOK','PHI','FCBC','SRCE','TD','CHE','TCOM','TWST','HPK','HTBI','MFG','TDY','ONCY','KLG','HTH','TWFG','PBF','CRESY','NNE','MNDY','TFPM','OSK','NFG','ABR','HUM','CHH','CDLR','MAA','ECPG','MAIN','LCII','FAT','GBLI','NBBK','SILV','SAMG','CFR','GMAB','OMAB','CCOI','EBC','AZTA','CSGP','CDNA','LYV','ALIM','CBAT','NAVI','AEP','NVEE','TM','CSTM','INVH','ITRI','NATL','EXC','DOX','MRTN','ESCA','QGEN','MYFW','SMAR','LTH','BWMX','CPK','IMXI','LZB','CNI','NU','USCB','ASUR','LND','FUNC','PBA','EXEL','RCM','HII','NFGC','AWI','GSK','WAY','VLGEA','KRP','TPB','FYBR','ARCO','ATR','KOP','SOHU','MEG','MRX','COYA','PDCO','CATY','CIEN','MGYR','ARCC','SNDR','MKL','HQY','AIRT','LGIH','PLSE','CODI','CLGN','SKYW','SSB','BOW','FORTY','OSIS','KMB','ESNT','KRT','LULU','FSI','ITI','LEGN','RITR','III','CSTL','ESLT','TOWN','SRCL','MOS','DHIL','GIII','ALKS','APP','POWI','GLAD','DRI','STZ','RHP','ARL','RARE','HON','HASI','KIM','CRBG','RVT','LNN','AXS','AGIO','YETI','MCB','PLNT','ATO','CTBI','ECL','ALV','CHT','CQP','CCRN','CXDO','BURL','CZWI','LENZ','POCI','FTI','STRW','KSPI','SUZ','WS','GLBE','AWK','FNV','HPE','EFSC','HG','CNA','CRGX','GDV','WLKP','FSFG','APLS','FCFS','PWSC','PBHC','WFC','GABC','VOC','TEAM','BIP','ALGN','MCI','MTB','MDXG','BAM','MCY','KE','BBCP','GLRE','CFG','CTSH','RXO','FEIM','MEOH','SNV','BDL','SWKS','AMCR','ONON','SCM','HTLF','LOVE','LANC','ADRT','ARMK','HSHP','CPBI','CODX','WOK','FBK','AMX','BME','CHRW','SLB','ACV','CLNE','ARDC','CINF','STBA','ADSE','TCBK','SHG','CPB','PHIN','CFFI','BST','OXY','FTV','BUR','ATEC','TCBI','AUPH','MPB','NIE','ALDX','WY','NVA','GAMB','HONE','NI','NBHC','MGM','WTTR','HWBK','GM','TEM','FUSB','YUM','EBF','CTRA','GOLD','GNT','AQST','GRC','BEAM','AVB','NVEC','ACNB','KURA','AGCO','VIK','UPS','TIMB','UL','PPL','REZI','PPIH','CC','DD','EPC','RYN','VXRT','RDDT','PBBK','SJM','TRP','WF','ALLY','HQH','ESSA','VOXX','OCS','DTE','CME','TSBK','EML','IOSP','NRIX','GRX','FOLD','ETO','THR','GAIN','VABK','FRA','FULT','NEU','BSRR','MHK','ALB','FMX','BNS','PFLT','ASYS','BLFS','QIPT','ACI','RUN','SHOO','CAG','SUNS','WSFS','AMPY','PAL','LAND','FBNC','WEC','MGEE','PTSI','MBUU','GIL','MSGE','FMBH','LNT','MAYS','ALTM','SVT','SIGI','AVT','BMY','FHI','INMD','MREO','UBCP','EVF','NHTC','LHX','HMNF','NBIX','ALGM','SUPN','LOPE','FOXA','AEO','VBNK','FCCO','METCB','JUNE','UPBD','GGZ','INFN','ARDT','IEX','CMPO','FOF','CPT','AMT','AESI','RLGT','LOCO','OLP','ASB','INSE','CRT','HDB','MAMO','TWIN','CBFV','DBX','BOWL','HQL','NATH','TTWO','CMS','BBDC','BCOW','EMX','FSK','ETR','ROIV','BWB','BPMC','BKU','AKRO','AEE','ASH','CBSH','ELS','CNOB']

TICKERS = ['RNP','STKS','BTU','CNL','SXT','BCSF','EIG','REYN','BTSG','HGTY','SBFG','HRTG','BCAL','SELF','UE','AVPT','JKHY','BNL','PPG','THG','PCB','FTS','RBB','OHI','BMRN','CPRI','WSR','SYY','VOXR','UPST','UAMY','CSCO','OXM','REXR','DGICB','MKSI','CADE','VC','CTLT','DESP','ALRM','GBCI','HLX','AES','CHMG','FRPH','WIX','CFB','NMFC','NHI','LATG','SGH','UVV','BSM','PCH','OI','FAF','VHI','RHI','GNTY','SKYH','CRNT','FVRR','PB','ULBI','SA','FFBC','WHF','WYY','XEL','IMTX','STAA','REG','TECTP','MGIC','RSSS','THRM','ONB','NJR','BWFG','MMS','VCYT','TTC','VMD','IOR','EDR','FSM','VVX','VRNT','LLYVK','FFIN','BDJ','FRLA','LSEA','ITUB','HBCP','MMM','TRU','BSET','MIDD','UVSP','GHLD','LE','BUSE','NXT','ICHR','FENC','KOPN','FCPT','CRDF','LXRX','GAB','ADC','RRBI','FMNB','VSH','EFT','IBTX','DLB','GTY','SILA','KARO','BIRK','INFU','GNTX','IMOS','AGNCN','FLO','LARK','AXTA','IRDM','EXK','COFS','GL','ACRS','PINE','ZION','ERO','MSGS','RM','FOX','ASND','IVCP','DGICA','SEIC','HOG','FT','INST','JMSB','AGNCM','BHF','CSR','LXP','BLW','AAOI','HRZN','HBAN','KTOS','SAR','CTGO','OCSL','RTO','GAP','GWRS','BP','ASIX','LI','BWEN','FC','BANX','PKBK','ORAN','EVBN','T','PETQ','CDE','OEC','GES','APA','FNLC','NTIC','BANR','JBSS','CLX','MBCN','ARMN','MYGN','INCR','LLYVA','IBEX','SMPL','HAFC','SBCF','CLBK','DOLE','HSTM','HSIC','HGV','VICR','RGR','RGLD','ATRC','PAAS','AHCO','ETB','DX','MSEX','VLYPO','ACEL','GCT','KINS','SUP','GRND','ATLX','PNRG','SRBK','STVN','AGS','BOTJ','LXEO','HI','BBIO','O','CTNM','ICL','RQI','AMTB','CON','SLP','AKAM','IVZ','AFRI','BKTI','SBUX','ENV','MKC','QSR','WERN','NARI','GCMG','PEBK','ARTNA','PDLB','THFF','PRDO','FRAF','PVH','BGFV','ZWS','JBI','UCB','PFIE','TNGX','TNGX','FMAO','MPV','HNNA','PSTL','UBSI','NYMTN','OS','AUB','RSF','PEBO','ETV','DSWL','ASTL','UTL','MFD','SPHR','EPAM','OPRA','ARIS','IMMR','LEVI','HY','RES','GSBC','GHC','ZTO','CWT','BILI','BFIN','FLS','ETSY','PPTA','EQR','EBTC','PNW','CVS','ARVN','ITRN','NXRT','BWA','RFI','FHN','SBSI','CE','TFC','AS','PHR','AIN','PFIS','FE','CHEF','SON','CPAY','CRK','RDCM','MTAL','CPF','BFST','CRVS','CYD','STWD','GEN','WLDN','AL','WAFD','C','SQSP','ZBAO','NREF','XPOF','FRME','BCBP','PINS','TAP','MCFT','ICUI','UONE','OGE','PTVE','ABL','SUI','DAY','WILC','HUN','ORA','RCKY','NICE','MAG','YORW','TR','TELO','FDP','FINW','SHYF','CBAN','HUT','PAGP','TU','ASTE','TRC','IDA','KRO','TTGT','NR','CNP','MMLP','TRMK','SDA','FDSB','FITBI','NXP','YELP','HST','WDS','RNST','ETW','EXPE','PSEC','WNEB','MMI','FBMS','PACK','CRWS','WBS','VBTX','ACGLO','RKT','GLDG','CZFS','DOCU','PAA','EVRG','PPSI','MMT','CART','KWR','XFLT','TCBX','LTRX','WSBF','ALRS','IMNM','PFE','BHFAP','IIIV','ABAT','PXS','LOAN','EVER','BL','LINE','MVBF','NRT','ARTV','HBNC','GLU','DNOW','CEP','NTR','MNDO','MOFG','USB','WDC','M','PAHC','ARDX','SQ','BEPC','ELLO','BCML','MANU','GUT','KMDA','BCE','CWBC','LANDM','ALVO','MRCC','CDP','DCOM','GMRE','BDX','CCI','ESS','NTRS','CHX','UDR','WTFCM','KEY','NPK','CBU','NTST','HBIO','MIR','TNL','BIO','CNSL','CRSP','AY','CMA','REI','NNN','NOVA','FTEK','CION','ECBK','YIBO','PII','ONIT','RAPP','SSTK','WOW','MSB','JHI','GCV','IAC','UGP','RMBI','FMN','OSPN','AROW','SITC','STRS','HLMN','GNSS','ATEX','ALOT','SW','PEGA','SPH','KYN','GBTG','BSTZ','CMCSA','MUI','UNF','TUSK','LTM','CIG','HRMY','TZOO','FA','G','RZB','NKE','STEL','TRIN','SGC','EOLS','WLY','FXNC','ZYXI','SBAC','SOLV','VNT','NXC','TEO','RVLV','HOPE','VTR','SLN','SFL','OFS','MYI','TCBS','AMWD','SLAB','CACC','SASR','MQY','DXR','RZLV','PLYA','ISDR','MDT','LSBK','CNH','MUJ','PFC','JPI','POET','OSW','FTDR','TDS','REFI','LCNB','AC','BTZ','TVTX','IMAX','CCEL','WTBA','REPL','SOI','ACTU','FHB','GBDC','MCR','PKOH','FRT','WTRG','CLCO','BANC','SEMR','SJW','HLIO','WNS','FDBC','PZZA','WSBC','GLDD','KTF','EFC','EBMT','MRC','CAC','POR','WLYB','CWAN','AORT','APLD','ESP','PGC','AWR','RFM','BVFL','UNB','ERIC','CZR','NXN','BHLB','EVN','IROQ','OBK','SHBI','LFT','BTOC','WMG','VRDN','MIY','GRAL','VPV','TITN','TVC','RSI','INMB','TROW','PRM','DRCT','PCYO','CXH','OMEX','THM','JEQ','D','NSP','EW','ZGN','MSBI','VTN','MUE','NOMD','UWMC','VZ','BCH','OIA','OXLCO','MLNK','LW','KMX','NWBI','SAFT','BAP','TLF','CSGS','TEF','CDTG','VLYPP','OBDC','BEEM','EQX','VKI','IFF','WEX','FISI','VCV','FSTR','LEA','SLRC','EH','NAN','CPZ','MQT','BLKB','HTBK','JHS','NKSH','CAKE','ALCO','FTF','SHAK','SPAI','CNXC','MATH','ANIP','MITK','MIN','CALC','DINO','SBRA','GIFI','PENN','NODK','RMM','PFX','IIM','DLY','DMF','IRTC','VRSN','MYE','OSS','EVTC','PMO','VIV','ALMS','LITE','AVA','BLMN','JKS','TRST','CCNE','INUV','SCS','MURA','PLL','PMM','COTY','TEAF','CPA','LCTX','BFS','KVUE','APLE','CARE','PIM','TCI','LCUT','SFNC','NWFL','SBH','GXO','ES','MUA','EPM','MVF','NYAX','MFM','VKQ','GSBD','JD','MUC','MHN','MNR','WPP','SLSR','TGNA','HFWA','EARN','CEV','PARR','VMO','DTF','CCCS','CELC','ISPR','JJSF','IRIX','RCI','OLED','PKE','AIRTP','PTEN','CUZ','KVYO','IQI','BMEZ','CADL','INDB','VGM','INBX','PRG','BIIB','ELPC','GEO','KIDS','SRDX','MAN','ENOV','SEE','VSTS','SMTC','CPAC','TAK','NMCO','BROS','SRTS','BFAM','NTCT','SLG','HOUS','ALEX','GFS','TBLD','ROIC','FSEA','BAFN','AVO','HP','ANAB','EPRX','CVBF','UBFO','ARHS','CBL','NVEI','BKH','WRLD','BMR','BTG','BALL','DOCN','SSSS','RMMZ','CMU','OOMA','MYD','JAZZ','ECAT','SSBI','DEO','ZM','GBAB','RMI','EDAP','MGF','PRTH','CZNC','CLSK','TBN','MVT','XBIT','IHTA','BCAT','PPT','HOFT','SR','BVN','FF','PSF','PTA','COLD','PVBC','MHD','EOT','LAUR','DRH','RAND','LTC','PROF','NOK','CTLP','SVM','QTWO','PFS','RDWR','CMCO','WEST','AXGN','DSL','LEO','TSN','TXO','SDHY','COLM','LADR','AIOT','BOH','MFIC','HFBL','ADNT','CDXC','APWC','SND','INFA','TCPC','KELYB','AMSF','KTCC','RECT','SWX','OGS','VITL','RBRK','ESGRO','AKR','AE','HTHT','DAVA','CIVB','CXE','VLY','CGNX','ORKT','WABC','HNVR','TXNM','UG','PPBI','PX','UVE','ESTC','ALE','PWOD','KELYA','ESGRP','KMPR','SCHL','HMN','PTMN','JBT','TDC','ASPI','BKD','OCFC','ACIC','HAYW','ANVS','MTN','NWE','AEF','SSIC','SEG','OPK','ALNT','ORMP','SBSW','LNKB','CTRN','TFSL','WPC','MOV','BLFY','KMT','HIW','BBU','ARE','PRVA','CXW','VZLA','FIBK','AGNC','TRS','ZUMZ','RWAY','KEP','ETON','SIBN','CARG','HCM','VTMX','DCBO','ZBH','CLST','AMBA','ISTR','MTA','PVL','HRL','UNIT','ICG','FVCB','MNSB','WEN','CGAU','MGA','NPWR','BLCO','GSIW','VRE','PMT','TYRA','KREF','DDI','OVBC','KN','LGCB','EIC','LFVN','ABNB','FRST','AMN','TME','SFST','SONO','FTHY','AGR','SILK','OPOF','OTEX','RITM','CHWY','NABL','MRAM','B','CHTR','IONS','STR','GOOD','TIGR','OXLC','ANIX','ITOS','PGRU','INCY','PDI','GGT','NIPG','ARWR','BV','NSTS','IMCR','NFBK','NTRB','EBR','BIDU','CNMD','BJRI','RIGL','MNSO','MATW','ENR','FBRT','SRRK','BEN','ICCC','SCL','LC','FINS','FUN','BSAC','SHO','BRLS','RBKB','CASS','TMP','KALU','APTV','CMPR','AMSWA','PKST','BALY','LVO','LBTYK','EQC','NDMO','RGCO','GTX','THS','GEL','CDRO','AHH','RIG','NCV','YUMC','NXG','AWRE','AMED','MG','MASI','PBFS','ESRT','CREX','NCZ','NEXT','FLYX','KALV','DAL','NNDM','FFIC','JELD','CRML','MDWD','LXFR','VPG','PROV','MRNO','PTCT','ATLO','CEVA','CNK','FULC','BRKL','NTIP','SEB','PLG','RSVR','BKT','PLAY','LVS','FGBI','FNWB','SHEN','LBTYA','FWRG','GEOS','WASH','FMC','POWW','PAYO','RFMZ','EXTO','CRI','TFX','AREC','DEA','PHAT','ST','HXL','NN','SMHI','DAN','ALX','AXL','VAC','SVCO','SDGR','ARI','PUMP','GENI','COE','FLUX','YOU','DWSN','ROG','SWI','TLK','JWN','WHR','ODD','SAM','MAIA','COLB','FONR','AVNS','RC','GLV','CSBR','UTMD','GAIA','AUNA','THRD','SWK','GFR','PAY','NEO','PDO','MKTX','LBTYB','BUD','ASRV','BSBR','AFYA','CIB','CAE','USIO','LEXX','STCN','CRMD','UONEK','MTW','SRL','SCPH','BRFH','SNN','DSX','SEVN','SMR','ATRO','NFE','IPI','IFS','SUUN','ENIC','PLUG','PHG','ASAI','CNNE','ALIT','NOV','FCEL','UIS','ATOM','BOC','DOCS','PEPG','NAII','TRUE','NEXA','QDEL','TNDM','SKM','ALKT','ATSG','BHM','SDST','BWAY','EHGO','FL','CTRI','LASR','WYNN','DEC','WKC','EGAN','PAYC','SMP','EEFT','HA','EPR','VGZ','CWK','AIRG','DOC','SMG','AFCG','HAO','VERI','IVAC','ENGN','DMRC','PLOW','RZLT','INVE','FIS','EE','LODE','CODA','SACH','RPD','HDL','XHR','FNWD','OKTA','UPWK','CFSB','PHVS','INTS','OZ','KOS','NICK','CNTA','NEWT','OCCI','MPX','RPRX','GALT','CVI','LPA','PYPL','GPN','EVC','DASH','YXT','STHO','SLNG','JOUT','ATOS','MDBH','ARAY','NLY','ENTX','ELME','JYNT','ALAB','VET','SID','DIS','PRT','ADAP','LPL','STXS','USPH','BSBK','BXMT','CCSI','RGC','CRGY','ANRO','MNTX','GCO','RDUS','ACNT','ENVX','WULF','LGL','OMCL','OUT','OXSQ','IONQ','PD','BXP','MXL','RBLX','FTRE','FNGR','TRTX','BRY','SATS','RVSB','BLNK','VNO','NVST','FBYD','SHC','GILT','HITI','FIVE','KAR','PRAA','HAS','IE','GT','BTMD','ALTG','MRSN','ABEV','TRDA','KRNT','PCOR','OGN','NMRA','YY','KRMD','PK','RGP','NBR','VYX','APPN','ATYR','EC','MODD','FCAP','NWN','CLIR','DXC','DLTR','AXTI','AAME','MLKN','ARKO','SERA','MLYS','RPAY','MESO','FLIC','PINC','GHI','HAE','DAWN','PLRX','APEI','NGNE','TWG','CGEM','RAMP','GRNT','ZD','ICMB','UROY','RKLB','XPRO','HR','STER','STRA','HHH','CSAN','INTG','TPVG','ARKR','TRVI','FMS','ACCO','VINP','LSXMB','SCWX','ALK','AOUT','AOMR','LIVN','AAT','NVRI','OSUR','YALA','GAUZ','EWTX','RVNC','EFXT','SBT','ACVA','VOD','VRA','SOUN','UHG','TGI','LILAK','LZM','CCO','XNET','WU','EVCM','CRMT','SOFI','FOXF','DK','ZIMV','KW','GNL','PRGO','LILA','USGO','AIRJ','APLT','NEWP','PUK','MAC','TBRG','AUDC','INN','VIAV','HMST','RMR','LVWR','ACRE','VLRS','VSCO','ACIU','CTOS','LUMN','LBRDK','LUV','SNAP','SG','LNC','MFH','PED','OKLO','NG','RLJ','AMBC','ZLAB','ELAN','CSIQ','PDSB','LBRDA','CNDT','KD','AUBN','ZUO','BGS','VIR','LSXMA','HURC','BBUC','BAK','WEAV','TLYS','DBRG','RDW','DNUT','ALHC','MODG','RBBN','LSXMK','NC','HUMA','BTDR','MLAB','MODV','HOOD','EXAS','EDU','QS','VZIO','ZK','HTLD','PRTS','RDFN','SMLR','VTLE','RNW','BFH','EEX','WHG','TIGO','AP','IAS','SGA','IMMX','UGI','VTRS','OFLX','GCI','NTWK','CCU','LPRO','BMRC','CRDL','ADGM','NAK','ZVRA','MCHX','PDM','TLSA','JACK','WBTN','PYCR','PRTC','TCRX','TURN','USNA','XP','KRNY','WWW','MAX','UAL','PAX','QXO','AURA','FLNC','DG','USAU','LUNR','GENK','BASE','IBTA','RUM','CCLD','FORR','TWLO','IFRX','RWT','GEG','S','QTRX','NEP','TYG','EGBN','MATV','EYPT','CLPR','FWRD','GTLB','XRAY','QRTEB','REFR','LIND','IRWD','UHT','TG','ARMP','BYON','BRFS','MTRX','VVI','KNOP','EVI','DV','LNSR','IOVA','MGLD','BRDG','ZURA','FLWS','ECVT','FLYW','AZI','BVS','TALO','YMAB','ADTN','YRD','ASLE','SPWH','PUBM','BEAT','OBIO','PARAA','ORGO','LRFC','KRC','CVGI','NNBR','OSCR','RTC','FIVN','ACRV','DRVN','ATNI','FFWM','WKME','CLDT','RFIL','DGHI','TRX','MERC','XYF','ILMN','LVRO','GB','OVID','AG','ACR','PLX','TOYO','KVHI','TLSI','ARQT','CGEN','BABA','DERM','HCSG','CFFN','OPRX','PCT','JBGS','MD','SSTI','GO','IAUX','XNCR','NWL','ELYM','MUX','SHCO','HBI','BRSP','SRAD','CIA','BYFC','AUGX','BAX','UFCS','DNB','FET','PODC','MTCH','CMTG','QUAD','SKYT','TRSG','GNLX','CNTX','SPRY','JOBY','NTGR','IPGP','FATBB','CYRX','EL','AVAH','FUFU','PEB','VUZI','BGSF','MFA','SMC','ARQ','COIN','CPNG','JAMF','BBD','ANIK','DHX','BA','VERU','SIRI','GTE','PAYS','DIN','DLX','STOK','SHIM','CXM','AQN','LICN','DOMO','STRO','CFLT','NCSM','CTXR','MRCY','FPH','MCS','HAIN','ZIP','VEON','NGVT','NRDS','GPRK','GRFS','DSY','AMBI','IDN','RMAX','SNOW','GHRS','ETWO','WTI','WFCF','CABA','CMRX','TERN','PHAR','CRSR','ATER','NEOG','LFCR','FROG','CHCT','NEXN','GDS','SILC','KSS','INTC','BORR','APPS','FNKO','FHTX','MX','JRSH','ACAD','OPFI','SAFE','FBIOP','ALLT','UA','ASAN','SNT','MBLY','TXG','SMWB','CERS','ETNB','OABI','ENFN','CLB','AVD','DEI','RDIB','PTLO','XPEV','CULP','EVGO','BDN','ZYME','ROKU','AFRM','LSPD','VREX','LEE','SNDA','SPR','SWIN','HCP','ANGO','URGN','CLVT','SVV','PGRE','SRI','TASK','NGL','TRIP','REKR','BEKE','FNA','RAY','AUR','AXIL','MTTR','PCRX','SSL','AIP','DBI','YTRA','MPAA','JMIA','UAA','YEXT','DLTH','VGAS','IGMS','DTI','AAL','IPHA','RMNI','BRZE','BMEA','AAN','TCX','CINT','NOTV','JFIN','GRWG','MNTK','GNTA','VNDA','CVU','ORIC','CANG','GDOT','TBNK','TOST','FDMT','DHC','EVLV','VYGR','STRM','SLND','TBPH','XRX','DARE','ALTI','BBDO','HELE','BIGZ','CLAR','LUNA','TACT','SNAL','LCID','NRC','ADV','DOGZ','INDI','RGNX','VFS','WALD','WMPN','TBI','LAB','STNE','ACDC','CHMI','DCGO','GETY','XPER','SEAT','EYE','MOBBW','PRA','MBI','BCG','WRAP','W','BHR','WAVE','SIFY','SGHC','SNBR','YMM','ABLV','COMM','AZ','UFI','GROY','LGCL','PSNL','CCL','BZ','MNRO','DC','VNET','AMBP','ORC','SSRM','ENZ','NCNO','OPAL','BLDP','EMBC','ANNX','FARO','BB','EWCZ','SBGI','TMQ','INSG','NCLH','NAPA','TSVT','OFIX','SFWL','CUK','AVAL','AVDX','COCH','LFST','HLLY','CCRD','LEG','EHAB','LITB','AKBA','CRBP','CSLR','YYGH','CRCT','NYXH','ANGI','NBTX','BW','JBLU','ACHR','NXDT','CSTE','KNDI','OIS','CATO','EUDA','GSIT','EVEX','SNCY','ATXS','CPS','TBLA','SERV','MRVI','IART','VTEX','NYCB','FTK','CVRX','GTN','ATHM','CERT','DRQ','MCW','FTHM','EVO','RILY','MSC','AMPS','AGAE','MPW','BRID','ELUT','GH','ZOM','BLDE','CNTY','SENS','CIM','BLZE','NPCE','NUVB','TORO','PACB','INZY','TSAT','PRO','UDMY','CTKB','BHC','AISP','ZI','MEI','PHX','MOLN','ALEC','GPRO','AUTL','TWO','RELY','VLN','GRAB','AAP','ALGT','BMTX','NOAH','PRLB','CIFR','CURV','CDTX','ATNM','VTVT','FEDU','NNOX','CABO','VIGL','MTLS','DAO','PSQH','BATL','HE','GLUE','OTLK','TCMD','SQNS','GCTS','NYMT','VTNR','PYXS','LMND','VALN','WBD','INGN','MGX','IREN','SEDG','CVGW','DLO','GOOS','GHG','MCRB','RCEL','ARR','DENN','FSP','INNV','MDV','CGNT','COMP','CDZI','MLCO','ASRT','ANEB','LTBR','SSYS','PRQR','EQ','HNST','ACXP','BRCC','LYFT','AJX','GTI','CLOV','ILPT','WVE','DDD','NAUT','KYTX','BOOM','NISN','GNFT','MGNX','OLMA','CBRL','WRBY','OB','TOUR','INO','FRSH','RANI','CLPS','GOTU','MDXH','SLRN','SNCR','MNOV','OPT','RNAC','U','DYAI','PRME','NDLS','ICAD','PROK','AI','XERS','AGBA','LTRN','PARA','GDEV','CMPS','QD','ODV','AIRS','GECC','RCON','DRTS','CETY','MSAI','SYT','SOPH','PLTK','IONR','SHLT','HPH','MXCT','QUBT','GEVO','IPW','NIU','YI','BRBS','BOLD','RLMD','NB','ONL','TAL','AHG','EOSE','GDC','VSAT','ITRG','NVCR','PETS','GRDI','CTSO','NVNO','RNG','EPOW','MGRM','CCCC','DSP','HCAT','VIVK','BPT','VFC','TMCI','XTNT','PBYI','FSLY','SWIM','ARBE','TELA','RGLS','BLRX','TPIC','OMER','NUS','CDXS','IEP','LAC','XMTR','WPRT','MRNS','FENG','TV','FARM','STG','MGTX','PAGS','HEPS','ULCC','CNF','FURY','GRPN','BAND','GTHX','MED','PROC','UEIC','ZEO','ZKH','FATE','KOD','CASI','FIGS','HLF','SVC','APYX','CMCM','MOMO','JSPR','MRT','SGHT','CRON','BCOV','RXRX','VNRX','CLLS','ELDN','SMXT','ABSI','LUNG','PRLD','RSKD','TKNO','XGN','MITT','VIOT','NINE','AMCX','LANV','BAER','MOND','SIEB','NVTS','VRCA','STTK','EXAI','PL','AKA','IHS','RDZN','MYO','PSFE','PSTX','SFIX','RLAY','PXLW','TALK','VATE','AENT','PTON','ENTA','ECX','CMP','VERV','HSAI','GLPG','WOLF','ARRY','OPEN','ALRN','KIND','PATH','OPRT','AADI','SHLS','GPMT','TREE','FLNT','SLS','LZ','HUYA','FAAS','WBA','PERF','SHOT','CMPX','EB','LPTX','MESA','PNST','PLUR','HFFG','BFLY','KZR','DIBS','HKD','WWR','ERAS','CURI','IVA','HYLN','IRON','VSTM','COUR','PGEN','GRFX','MQ','BLND','CYBN','BTM','CTV','SGMT','ZENV','HOUR','HPP','TLS','AMPL','CRGO','CMBM','COOK','FUBO','LX','MOGO','GDRX','TNYA','SCOR','TCS','TWKS','REAL','EDIT','LGO','WB','ANL','RERE','KULR','BDSX','BDTX','SANA','ORGN','OLO','MYPS','DOUG','RDI','CVM','RAPT','SHCR','OPTN','WIMI','PSNY','ML','SSP','SYRE','LNZA','LESL','DSGN','ECOR','OCUP','JRVR','CTMX','ESGL','CHPT','SMRT','QSG','GYRE','EBS','VSTA','RIVN','GAN','BBAI','AMLX','ASMB','BARK','SKIN','RVPH','CMCT','PRAX','AFMD','RENB','RXT','XBP','BGM','LVTX','ZNTL','LAW','MYTE','DCTH','HOWL','PRCH','TARA','SABR','SLDP','ONDS','FRGE','SLQT','TOON','TIXT','SELX','NEGG','NOTE','SST','SCYX','WBX','FBLG','TDOC','KUKE','AVIR','QURE','SPRO','EYEN','VTGN','KLXE','TELL','AGL','OPTX','ECDA','PRPL','CRNC','GLT','PMN','LDI','WDH','TYGO','QTTB','ESLA','CMTL','GGR','NKTX','ABOS','DDL','SRG','DAVE','ADPT','BROG','SHIP','TOP','IQ','FREY','ELBM','SCLX','IHRT','CRBU','NWTN','CRVO','TSE','FOA','SPIR','VTYX','BNAI','BYSI','FORA','PGY','WGS','AUID','CAN','BRLT','TMC','NMG','TISI','SATL','MNY','PSNYW','HTZ','LVLU','OCX','SJ','WOOF','GORO','DH','TTEC','IMUX','RMTI','OCEA','IH','HRTX','NRDY','BMBL','RPHM','ICLK','LOOP','TRML','IRBT','OGI','QSI','SES','RPTX','CLRB','HLVX','RRGB','MAPS','KLTR','BRNS','AKYA','ADCT','DOYU','CDLX','AILE','PET','VMEO','GBIO','HYPR','TRVG','OLPX','KC','LSF','NRGV','ACHV','ADAG','AKTX','QBTS','SER','DRRX','TSHA','VFF','ALLO','OPI','PROP','AEON','ONTF','SKYE','NCMI','AVTE','IMAB','DTC','BIGC','THTX','AGEN','BKSY','LAZR','ROOT','LEV','SY','RLYB','EGHT','AGMH','TUP','CKPT','ATUS','HUIZ','FOSL','USAS','OMGA','RGTI','MKTW','RFL','KPTI','EGRX','ZVIA','EVTL','ZEPP','ABEO','UCL','TECX','MASS','AIXI','CUE','AMPX','SKYX','UNCY','OCGN','SAVE','LYEL','SGMO','EM','ALAR','LUCD','DADA','CNTB','SKIL','IMRX','AZUL','ANTX','RMBL','INKT','NVX','QRTEA','ARBK','THCH','MIST','NSPR','IPSC','DNMR','ALXO','LILM','ZH','CHRS','HIPO','NCTY','NKTR','UPLD','FBIO','ATAI','NVRO','SRZN','OUST','ALUR','HOOK','SHFS','KRRO','IVR','BZFD','PLCE','VANI','BNTC','RLX','BCAB','DFLI','CHGG','PLBY','TUYA','SLDB','BEDU','EXFY','ELEV','ADVM','EGIO','INVZ','IOBT','TLRY','RGS','IKNA','EAF','EHTH','FANH','XLO','KORE','SAGE','AEVA','CVAC','ASPS','BZUN','PIII','GRTS','XFOR','MOVE','ESPR','CARM','LSB','GOSS','STEM','AIEV','DM','LU','SATX','ACHL','OTLY','AMC','TVGN','DBVT','KPLT','PRE','BKKT','BNGO','DTIL','ABCL','NXTC','PMVP','PHUN','BYND','IVVD','RPID','EBON','GWH','AMRN','API','TDUP','IMPP','KSCP','KRON','YSG','SPRU','ALGS','QNCX','BETR','SOND','CPTN','STI','OWLT','PASG','BNED','ME','ALVR','ARQQ','SEER','CLNN','CELU','RENT','SPCE','LPSN','SKLZ','GROV','TIL','PDYN','GOCO','SNDL','ATRA','MPLN','BEST','ELTX','LLAP','MVST','VOR','DOMA','OPAD','SWVL','AMTD','WW','ACET','MKFG','MYND','FEAM','HYMC','RBOT','BNR','BIRD','CCG','NKLA','AMWL','UP','CGC','VCSA','XOS','TPST','EVA','CTRM','BHIL','SYRS','DNA','SDIG','CBUS','BYU','BODI','OCFT','REE','FGEN','AXDX','LOGC','BLUE','ALLK','ACB','BGXX','MTC','GOEV','GLBS','UXIN','NAAS','NEUE','NUTX','AIRE','KPRX','AHT','WTO','NRBO','TTOO','XTKG','CENN','FFIE','TOPS','AIV','CIO']

def get_revenue_data(ticker):
    try:
        stock = yf.Ticker(ticker)
        
        # Get annual financials
        financials = stock.financials
        
        if financials.empty:
            print(f"No financial data available for {ticker}")
            return None
        
        # Filter out years with empty revenue data
        valid_years = [year for year in financials.columns if pd.notna(financials.loc['Total Revenue', year])]
        
        if not valid_years:
            print(f"No valid revenue data available for {ticker}")
            return None
        
        # Sort the valid years in ascending order
        sorted_years = sorted(valid_years)
        
        # Find the oldest available year with non-empty data
        oldest_year = sorted_years[0].year
        oldest_revenue = financials.loc['Total Revenue', sorted_years[0]]
        
        # Find the most recent year (2023 or 2022) with non-empty data
        most_recent_year = None
        most_recent_revenue = None
        
        for year in reversed(sorted_years):
            if year.year in [2023, 2022]:
                most_recent_year = year.year
                most_recent_revenue = financials.loc['Total Revenue', year]
                break
        
        if most_recent_year is None:
            print(f"No data for 2023 or 2022 found for {ticker}")
            return None
        
        # Calculate percentage change
        percent_change = ((most_recent_revenue - oldest_revenue) / oldest_revenue) * 100
        
        return {
            'Oldest Revenue Year': oldest_year,
            'Oldest Revenue': oldest_revenue,
            'Most Recent Revenue Year': most_recent_year,
            'Most Recent Revenue': most_recent_revenue,
            'Percent Change': percent_change
        }
    except Exception as e:
        print(f"Error processing {ticker}: {str(e)}")
        return None

# Create a list to store results
results = []

# Process all tickers
for ticker in TICKERS:
    data = get_revenue_data(ticker)
    if data is not None:
        results.append({'Ticker': ticker, **data})
        print(f"Processed {ticker}")
    else:
        print(f"Could not retrieve data for {ticker}")
    time.sleep(1)  # Add a delay to avoid hitting rate limits

# Create a DataFrame from the results
df = pd.DataFrame(results)

# Check if the DataFrame is empty
if df.empty:
    print("No data was retrieved for any of the tickers.")
else:
    # Check if 'Most Recent Revenue' column exists
    if 'Most Recent Revenue' in df.columns:
        # Sort the DataFrame by most recent revenue in descending order
        df = df.sort_values('Most Recent Revenue', ascending=False)

        # Format the 'Percent Change' column
        if 'Percent Change' in df.columns:
            df['Percent Change'] = df['Percent Change'].apply(lambda x: f"{x:.2f}%")

        # Display the results
        print("\nSorted Results:")
        print(df)

        # Save to CSV
        df.to_csv('revenue_comparison.csv', index=False)
    else:
        print("'Most Recent Revenue' column not found in the data.")
        print("Available columns:", df.columns.tolist())
